'/bootstrap':signature(getMasterRules(Matches,MasterRules)::'/impred':impred,[Matches::'/bootstrap':list('/nodalion':databaseValue(_,axiom,_)),MasterRules::'/bootstrap':list('/nodalion':databaseValue(_,axiom,_))]).
'/util':behavior(getMasterRules(Matches,Rules)::'/impred':impred,!'should retrieve an empty list if the master version is an empty string', ('/impred':simulate(getMasterRules(['/nodalion':value(!master,version,[!''])],Empty),[],'/impred':true),'/util':assertEqual(Empty,[],'/bootstrap':list('/nodalion':databaseValue(_,axiom,_))))).
'/util':behavior(getMasterRules(Matches,Rules)::'/impred':impred,!'should fetch the rules from local storage', ('/impred':simulate(getMasterRules(['/nodalion':value(!master,version,[!'ver1'])],Rules),['/impred':task('/impred':localGet(!'ver1'),masterRules(['/nodalion':counterValue(!rules,rule(example:someFact(X,Y),builtin:true,example:someFact(Y,X)),1)]),'/impred':localStoreVal)],'/impred':true),'/util':assertEqual(Rules,['/nodalion':counterValue(!rules,rule(example:someFact(X,Y),builtin:true,example:someFact(Y,X)),1)],'/bootstrap':list('/nodalion':databaseValue(_,axiom,_))))).
'/util':behavior(getMasterRules(Matches,Rules)::'/impred':impred,!'should go to the database if rules are not in local storage', ('/impred':simulate(getMasterRules(['/nodalion':value(!master,version,[!'ver1'])],Rules),['/impred':task('/impred':localGet(!'ver1'),_,'/impred':localStoreVal),'/impred':task('/nodalion':trans(!'_masters',!'ver1',['/nodalion':getAllCounters(!rules)]),['/nodalion':counterValue(!rules,rule(example:someFact(X,Y),builtin:true,example:someFact(Y,X)),1)],'/bootstrap':list('/nodalion':databaseValue('/bootstrap':string,axiom,_))),'/impred':task('/impred':localSet(!'ver1',masterRules(['/nodalion':counterValue(!rules,rule(example:someFact(X,Y),builtin:true,example:someFact(Y,X)),1)])),_,'/impred':localStoreVal)],'/impred':true),'/util':assertEqual(Rules,['/nodalion':counterValue(!rules,rule(example:someFact(X,Y),builtin:true,example:someFact(Y,X)),1)],'/bootstrap':list('/nodalion':databaseValue(_,axiom,_))))).
annotation:shrink('/impred':clause(getMasterRules(Matches,Rules),'/impred':conj('/impred':pred('/bootstrap':listMember('/nodalion':value(!master,version,[Version]),'/nodalion':databaseValue(_,axiom,'/bootstrap':string),Matches)),'/impred':if('/impred':pred(Version::'/bootstrap':string=annotation:parentheses(!'')::'/bootstrap':string),'/impred':pred(Rules::'/bootstrap':list('/nodalion':databaseValue('/bootstrap':string,axiom,T2))=[]::'/bootstrap':list('/nodalion':databaseValue(_,axiom,_))),'/impred':conj('/impred':task('/impred':localGet(Version),masterRules(Rules),'/impred':localStoreVal),'/impred':if('/impred':pred(builtin:var(Rules::'/bootstrap':list('/nodalion':databaseValue('/bootstrap':string,axiom,T2)))),'/impred':conj('/impred':task('/nodalion':trans(!'_masters',Version,['/nodalion':getAllCounters(!rules)]),Rules,'/bootstrap':list('/nodalion':databaseValue('/bootstrap':string,axiom,T2))),'/impred':task('/impred':localSet(Version,masterRules(Rules)),_,'/impred':localStoreVal)),'/impred':true)))))).
